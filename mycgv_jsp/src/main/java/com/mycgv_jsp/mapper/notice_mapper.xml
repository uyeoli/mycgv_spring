<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace = "mapper.notice">

	<select id = "list" parameterType = "map" resultType = "com.mycgv_jsp.vo.NoticeVo">
		select rno, nid, ntitle, ncontent, nhits, ndate
				from (select rownum rno, nid, ntitle, ncontent, nhits, to_char(ndate, 'yyyy-mm-dd') ndate
         				 from (select nid, ntitle, ncontent, nhits, ndate from mycgv_notice order by ndate desc))
              				 where rno between #{start} and #{end}
	</select>
	
	<select id = "content" parameterType = "String" resultType = "com.mycgv_jsp.vo.NoticeVo">
		SELECT NID, NTITLE, NCONTENT, NHITS, TO_CHAR(NDATE,'YYYY-MM-DD') NDATE FROM MYCGV_NOTICE WHERE NID = #{nid}
	</select>
	
	<insert id = "insert" parameterType = "com.mycgv_jsp.vo.NoticeVo">
		INSERT INTO MYCGV_NOTICE (nid, ntitle, ncontent, nhits, ndate, nfile1, nsfile1, nfile2, nsfile2)
			VALUES('n_'||ltrim(to_char(sequ_mycgv_notice.nextval, '0000')),#{ntitle},#{ncontent},0,SYSDATE,#{nfile1}, #{nsfile1}, #{nfile2}, #{nsfile2})
	</insert>
	
	<update id = "update" parameterType = "com.mycgv_jsp.vo.NoticeVo">
		update mycgv_notice set ntitle = #{ntitle}, ncontent = #{ncontent} where nid = #{nid}
	</update>
	
	<delete id = "delete" parameterType = "String">
		delete from mycgv_notice where nid = #{nid}
	</delete>
	
	<update id = "updateHits" parameterType = "String">
		update mycgv_notice set nhits = nhits + 1 where nid = #{nid}
	</update>
</mapper>